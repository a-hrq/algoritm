#include<stdio.h>
#include<stdlib.h>
#include<string.h>

int main(){
int M, N;
int j, i, qtd;
printf("Digite a quantidade de linhas do mapa: ");
scanf("%d", &M);
printf("Digite a quantidade de linhas do mapa: ");
scanf("%d", &N);

if(!(1 <= M <= 999 && 1 <= N <= 999)){
exit(1);
}

char **mapa = (char**) malloc(M*sizeof(char*));
for(j = 0; j < M; j++){
    mapa[j] = (char*) malloc(N*sizeof(char));
}
printf("\n\n");
fflush(stdin);
for(j = 0; j < M; j++){
scanf("%s[^\n]", mapa[j]);
}
qtd = 0;
for(j = 0; j < M; j++){
 for(i = 0; i < N; i++){

   if(mapa[j][i] == '#'){

    if(j == 0 && i == 0){
      if(mapa[j+1][i] == '.' || mapa[j][i+1] == '.' ){
        qtd++;
      }
    }

    if(j == M-1 && i == 0){
      if(mapa[j-1][i] == '.' || mapa[j][i+1] == '.' ){
        qtd++;
      }
    }

    if(j == 0 && i == N-1){
      if(mapa[j+1][i] == '.' || mapa[j][i-1] == '.' ){
        qtd++;
      }
    }

    if(j == M-1 && i == N-1){
      if(mapa[j-1][i] == '.' || mapa[j][i-1] == '.' ){
        qtd++;
      }
    }

    if(j == 0 && i != 0 && i != N-1){
      if(mapa[j+1][i] == '.' || mapa[j][i-1] == '.' || mapa[j][i+1] == '.'){
        qtd++;
      }
    }

    if(j == M-1 && i != 0 && i != N-1){
      if(mapa[j-1][i] == '.' || mapa[j][i-1] == '.' || mapa[j][i+1] == '.'){
        qtd++;
      }
    }

    if(j != 0 && j != M-1 && i == 0){
      if(mapa[j-1][i] == '.' || mapa[j+1][i] == '.' || mapa[j][i+1] == '.'){
        qtd++;
      }
    }

   if(j != 0 && j != M-1 && i == N-1){
      if(mapa[j-1][i] == '.' || mapa[j+1][i] == '.' || mapa[j][i-1] == '.'){
        qtd++;
      }
    }

   if(j != 0 && j != M-1 && i != 0 && i != N-1){
    if(mapa [j+1][i] == '.' || mapa [j][i+1] == '.' || mapa [j][i-1] == '.' || mapa [j-1][i] == '.'){
        qtd++;
       }
   }

  }

 }
}
printf("\n %d", qtd);

for(qtd = 0; qtd < M; qtd++){
  free(mapa[qtd]);
}

free(mapa);

return 0;
}
